////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// @file    include/nbfmm/kernel_functions.hpp
/// @brief   The definition of kernel functions
///
/// @author  Mu Yang <emfomy@gmail.com>
///

#ifndef NBFMM_KERNEL_FUNCTIONS_HPP_
#define NBFMM_KERNEL_FUNCTIONS_HPP_

#include <nbfmm/config.hpp>

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  The namespace NBFMM
//
namespace nbfmm {

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// The type alias of kernel function
///
typedef float2 (*KernelFunction)(const float2, const float);

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// The acceleration of gravity
///
inline float2 KernelGravity( const float2 pos, const float mass ) {
  float2 acc;
  float r = sqrt(pos.x * pos.x + pos.y * pos.y);
  float tmp = mass / (r*r*r);
  acc.x = pos.x * tmp;
  acc.y = pos.y * tmp;
  return acc;
}

}  // namespace lorasc

#endif  // NBFMM_KERNEL_FUNCTIONS_HPP_
